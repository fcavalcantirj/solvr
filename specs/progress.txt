2026-02-07: Add model field to agents table
- Created migration 000025_add_agent_model.up.sql and down.sql
- Added Model field to Agent struct in models/agent.go
- Updated db/agents.go: agentColumns, Create(), Update(), scanAgent(), scanAgentRows()
- Updated RegisterAgentRequest to include optional model field
- Updated UpdateAgentRequest to include optional model field
- Updated RegisterAgent handler to validate and persist model
- Updated UpdateAgent handler to allow model changes
- Added tests: TestAgentRepository_Create_WithModel, TestAgentRepository_Create_WithoutModel, TestAgentRepository_Update_WithModel
- All tests pass, build successful

2026-02-07: Add karma bonus when agent model field is set
- Updated RegisterAgent handler: +10 karma when model is provided on registration
- Updated UpdateAgent handler: +10 karma when model is set for first time (was empty)
- Tracks previous model state to avoid duplicate bonus when changing models
- Added tests: TestRegisterAgent_ModelKarmaBonus, TestRegisterAgent_NoModelNoKarmaBonus
- Added tests: TestUpdateAgent_ModelKarmaBonus_FirstTime, TestUpdateAgent_ModelKarmaBonus_NoBonus
- All agent tests pass

2026-02-07: Add GET /v1/users/{id}/agents endpoint
- FindByHumanID method already existed in db/agents.go
- Added FindByHumanID to AgentRepositoryInterface in handlers/agents.go
- Added UsersAgentRepositoryInterface to handlers/users.go
- Added SetAgentRepository method and agentRepo field to UsersHandler
- Created GetUserAgents handler to list agents by human_id
- Added route GET /v1/users/{id}/agents to router.go
- Updated InMemoryAgentRepository and all mock repositories with FindByHumanID
- Added tests: TestGetUserAgents_Success, TestGetUserAgents_Empty, TestGetUserAgents_MissingUserID
- Returns agent list with basic info (api_key_hash excluded)
- Returns empty array for users with no agents
- All agent and user tests pass

2026-02-07: Add GET /v1/users endpoint to list all users
- Added UserListItem and PublicUserListOptions models to models/user.go
- Added List method to UserRepository in db/users.go with agents_count subquery
- Added UsersUserListRepositoryInterface to handlers/users.go
- Added SetUserListRepository method and userListRepo field to UsersHandler
- Created ListUsers handler with limit/offset/sort query params
- Limit defaults to 20, max 100; sort: newest (default), karma, agents
- Added route GET /v1/users to router.go
- Added tests: TestListUsers_Success, TestListUsers_WithPagination, TestListUsers_LimitMax100, TestListUsers_DefaultLimit20, TestListUsers_Empty
- Response includes: id, username, display_name, avatar_url, karma, agents_count, created_at
- Does NOT expose email or auth_provider_id
- All user tests pass

2026-02-07: Wire PATCH /v1/agents/{id} route for updating agent profile
- Updated UpdateAgent handler to support both JWT and API key auth
- Human owner can update via JWT (human_id must match)
- Agent can update itself via API key (agentID must match)
- Added route PATCH /v1/agents/{id} to router.go with CombinedAuthMiddleware
- Added tests: TestUpdateAgent_WithAPIKey, TestUpdateAgent_APIKey_WrongAgent
- All agent tests pass

2026-02-07: Verify agents cannot be re-claimed via database trigger
- Confirmed trigger_prevent_agent_reclaim exists in migration 000018_add_agent_claim_fields.up.sql
- Trigger prevents UPDATE of human_id when already set (raises error with ERRCODE P0001)
- ConfirmClaim handler checks agent.HumanID != nil and returns 409 CONFLICT with "AGENT_ALREADY_CLAIMED"
- Test TestConfirmClaim_AgentAlreadyClaimed_Returns409 verifies this behavior
- All claim tests pass

2026-02-07: Add TypeScript types for claiming and user list features
- Added model?, human_id?, human_claimed_at? fields to APIAgent interface
- Added APIClaimInfoResponse type: { agent?, token_valid, expires_at?, error? }
- Added APIConfirmClaimResponse type: { success, agent, redirect_url, message }
- Added APIUserListItem type: { id, username, display_name, avatar_url?, karma, agents_count, created_at }
- Added APIUsersResponse type with data and meta pagination
- Added APIUserAgentsResponse type with data and meta
- Types compile without errors

2026-02-07: Add API client methods for claiming and user features
- Added getClaimInfo(token): GET /v1/claim/{token}
- Added confirmClaim(token): POST /v1/claim/{token}
- Added getUserAgents(userId, params?): GET /v1/users/{id}/agents
- Added getUsers(params?): GET /v1/users?limit&offset&sort
- Added updateAgent(agentId, data): PATCH /v1/agents/{id}
- All methods use typed responses and handle errors via fetch wrapper
- Types compile without errors

2026-02-07: Create /settings/agents page for agent management and claiming
- Created frontend/app/settings/agents/page.tsx
- Added MY AGENTS nav item to settings-layout.tsx with Bot icon
- MyAgentsList shows user's claimed agents with display_name, bio, karma, model
- Agent cards link to /agents/{id} and show HUMAN-BACKED badge if applicable
- Empty state shows "No agents yet" message
- ClaimAgentSection with instructions for CLI and MCP tool
- Token input with CLAIM AGENT button calls POST /v1/claim/{token}
- Success shows agent info with link, error shows appropriate messages
- Uses SettingsLayout which handles auth redirect

2026-02-07: Create /claim/[token] page for direct URL claiming
- Created frontend/app/claim/[token]/page.tsx
- Fetches claim info via GET /v1/claim/{token} on page load
- Shows error state for invalid/expired tokens
- Unauthenticated: shows agent info + "Login to claim" button (redirects to /login?next=/claim/{token})
- Authenticated: shows agent info + "Claim This Agent" button
- Displays: display_name, bio, karma, post_count, created_at
- Shows expires_at countdown (e.g., "Expires in 23h 45m")
- Success state: shows celebration with HUMAN-BACKED badge earned + link to /agents/{id}
- Error handling for expired, already_claimed, invalid tokens

2026-02-07: Redirect /connect/agent to /settings/agents
- Replaced 819-line frontend/app/connect/agent/page.tsx with simple redirect
- If authenticated: redirect to /settings/agents
- If not authenticated: redirect to /login?next=/settings/agents
- Shows loading spinner while checking auth state

2026-02-07: Add MY AGENTS item to user dropdown menu
- Added Bot icon import to user-menu.tsx and header.tsx
- Added MY AGENTS menu item after PROFILE in user-menu.tsx with Bot icon
- Added MY AGENTS link to mobile menu in header.tsx after PROFILE
- Links to /settings/agents

2026-02-07: Display Human-Backed badge on agent profile pages
- Badge was partially implemented, adjusted to match requirements
- Shield icon (14px), text 'HUMAN-BACKED', py-0.5
- Added title tooltip: "This agent is verified by a human backer"
- Badge shows when agent.hasHumanBackedBadge is true

2026-02-07: Display backed agents section on user profile pages
- Added backedAgents state and useEffect to fetch via api.getUserAgents()
- Added BACKED AGENTS section below stats row
- Grid displays agent cards with: display_name, bio snippet, karma, Shield icon
- Each card links to /agents/{id}
- Section only shows if user has backed agents (silently fails if API errors)

2026-02-07: Create /users page listing all human users
- Created frontend/hooks/use-users.ts hook following useAgents pattern
- Created frontend/hooks/use-users.test.ts with 10 tests (all passing)
- Created frontend/app/users/page.tsx with UsersList component
- Page includes: sort dropdown (Newest/Karma/Agents), pagination, stats header
- User cards show: avatar, display_name, username, karma, agents_count
- Each card links to /users/{id}
- Styled consistently with /agents page (monospace fonts, border styling)
- All 280 frontend tests pass

2026-02-07: Update /join page AI Agent Account button
- Changed AI Agent Account from Link to button with onClick handler
- Added useRouter from next/navigation for programmatic navigation
- Added handleAgentAccountClick function that checks isAuthenticated
- If authenticated: navigates to /settings/agents
- If not authenticated: navigates to /login?next=/settings/agents
- Updated description text from "For autonomous systems operated by organizations" to "Claim an AI agent you operate"
- Created frontend/app/join/page.test.tsx with 7 tests (TDD approach)
- All 287 frontend tests pass

2026-02-07: Show model field on agent profile pages
- Added model?: string field to AgentData interface in hooks/use-agent.ts
- Added model to transformAgent function input type and return object
- Added model display to agent profile page after bio section
- Format: 'MODEL: {model}' in font-mono text-xs text-muted-foreground
- Only displays when model is set and not empty
- Created frontend/app/agents/[id]/page.test.tsx with 9 tests (TDD approach)
- All 296 frontend tests pass

2026-02-07: Add edit model functionality for owned agents in settings
- Created frontend/components/settings/edit-agent-modal.tsx component
- Modal shows current model value and allows editing
- Calls PATCH /v1/agents/{id} with new model value on save
- Added editingAgent state to /settings/agents page
- Added Edit button (Pencil icon) on each agent card
- Restructured agent card: Link wraps content, Edit button separate
- Modal closes and refreshes agent list on successful save
- Shows error message if save fails
- Created frontend/app/settings/agents/page.test.tsx with 9 tests (TDD approach)
- All 305 frontend tests pass

2026-02-07: Show Human-Backed badge indicator in /agents list view
- Badge already implemented in components/agents/agents-list.tsx
- Adjusted Shield icon size from w-3.5 h-3.5 (14px) to w-3 h-3 (12px) per spec
- Updated tooltip from "Human Backed" to "Human-backed agent" per spec
- Added test: 'does not show human backed badge for non-verified agents'
- Updated test: 'shows human backed badge for verified agents' to verify tooltip text
- All 306 frontend tests pass

2026-02-07: Add USERS link to header navigation
- Added USERS link to desktop nav between AGENTS and API in header.tsx
- Added USERS link to mobile nav menu between AGENTS and API
- Link href: /users with same styling as other nav links
- Created frontend/components/header.test.tsx with 7 tests (TDD approach)
- Tests verify: link presence, positioning, mobile menu, styling
- All 313 frontend tests pass
