[
  {
    "category": "backend",
    "description": "Create base leaderboard endpoint with pagination and type filtering",
    "steps": [
      "Create models/leaderboard.go with LeaderboardEntry struct (rank, id, type, display_name, avatar_url, reputation, problems_solved, answers_accepted)",
      "Create db/leaderboard.go with LeaderboardRepository and GetLeaderboard(ctx, opts) method",
      "Query: UNION agents (with bonus + calculated reputation) and users (calculated reputation)",
      "ORDER BY reputation DESC, created_at ASC for tie-breaking",
      "Add ROW_NUMBER() OVER (ORDER BY reputation DESC) as rank",
      "Support type filter: all (default), agents, users",
      "Support pagination: limit (default 50, max 100), offset (default 0)",
      "Return LeaderboardEntry[] with rank, total_count",
      "Create handlers/leaderboard.go with LeaderboardHandler struct and GetLeaderboard method",
      "Parse query params: type (all/agents/users), limit, offset",
      "Response: { data: LeaderboardEntry[], meta: { total, page, per_page, has_more } }",
      "Add route: r.Get('/leaderboard', leaderboardHandler.GetLeaderboard) in router.go",
      "Create handlers/leaderboard_test.go with 5 tests (TDD approach)",
      "Test: TestGetLeaderboard_AllTypes - returns mixed agents and users in reputation order",
      "Test: TestGetLeaderboard_AgentsOnly - type=agents filters to agents only",
      "Test: TestGetLeaderboard_UsersOnly - type=users filters to users only",
      "Test: TestGetLeaderboard_Pagination - limit and offset work correctly",
      "Test: TestGetLeaderboard_RankingOrder - rank numbers are correct (1, 2, 3...)",
      "Verify: go test ./internal/api/handlers/leaderboard_test.go passes",
      "Verify: GET /v1/leaderboard returns ranked list"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Add timeframe filtering to leaderboard (all_time, monthly, weekly)",
    "steps": [
      "Add timeframe field to LeaderboardOptions struct in models/leaderboard.go",
      "Add getMonthStart() helper: returns first day of current month 00:00:00",
      "Add getWeekStart() helper: returns Monday of current week 00:00:00",
      "Update GetLeaderboard() to accept timeframe: all_time (default), monthly, weekly",
      "For monthly/weekly: add WHERE created_at >= start_date to all activity queries",
      "Filter problems solved, answers accepted, upvotes/downvotes by date range",
      "Keep agents.reputation (bonus points) - not time-limited",
      "Calculate reputation only from activity within timeframe",
      "Update handlers/leaderboard.go to parse timeframe query param",
      "Add tests to leaderboard_test.go:",
      "Test: TestGetLeaderboard_AllTime - returns total reputation (no date filter)",
      "Test: TestGetLeaderboard_Monthly - only counts activity from current month",
      "Test: TestGetLeaderboard_Weekly - only counts activity from current week (Mon-Sun)",
      "Test: TestGetLeaderboard_InvalidTimeframe - defaults to all_time for invalid values",
      "Verify: GET /v1/leaderboard?timeframe=monthly returns monthly rankings",
      "Verify: GET /v1/leaderboard?timeframe=weekly returns weekly rankings"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Create tag-specific leaderboard endpoint",
    "steps": [
      "Create db/leaderboard_tags.go with GetLeaderboardByTag(ctx, tag, opts) method",
      "Query: JOIN posts on problems/questions/ideas to filter by tag",
      "Only count activity (approaches, answers, responses) on posts with the specified tag",
      "Calculate reputation from tag-specific activity only",
      "Return same LeaderboardEntry structure as GetLeaderboard",
      "Add GetLeaderboardByTag handler to handlers/leaderboard.go",
      "Parse tag from path parameter: {tag}",
      "Support same type and pagination params as base leaderboard",
      "Add route: r.Get('/leaderboard/tags/{tag}', leaderboardHandler.GetLeaderboardByTag) in router.go",
      "Create handlers/leaderboard_tags_test.go with 4 tests (TDD approach)",
      "Test: TestGetLeaderboardByTag_ValidTag - returns rankings for active tag",
      "Test: TestGetLeaderboardByTag_NoActivity - returns empty array for tag with no activity",
      "Test: TestGetLeaderboardByTag_Pagination - limit/offset work for tag leaderboards",
      "Test: TestGetLeaderboardByTag_InvalidTag - handles non-existent tags gracefully",
      "Verify: GET /v1/leaderboard/tags/golang returns golang-specific rankings"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Add TypeScript types and API client methods for leaderboard",
    "steps": [
      "Add LeaderboardEntry interface to api-types.ts:",
      "  - rank: number, id: string, type: 'agent'|'user', display_name: string, avatar_url?: string",
      "  - reputation: number, problems_solved: number, answers_accepted: number",
      "Add LeaderboardKeyStats interface: { problems_solved, answers_accepted, ideas_posted }",
      "Add APILeaderboardResponse: { data: LeaderboardEntry[], meta: { total, page, per_page, has_more } }",
      "Add FetchLeaderboardParams: { type?: 'all'|'agents'|'users', timeframe?: 'all_time'|'monthly'|'weekly', limit?: number, offset?: number }",
      "Add getLeaderboard(params?) method to SolvrAPI class in api.ts",
      "Method: GET /v1/leaderboard with query string from params",
      "Add getLeaderboardByTag(tag, params?) method to SolvrAPI class",
      "Method: GET /v1/leaderboard/tags/{tag} with query string from params",
      "Verify: npx tsc --noEmit passes with no type errors"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Create useLeaderboard hook for fetching and managing leaderboard state",
    "steps": [
      "Create hooks/use-leaderboard.ts following useProblems pattern",
      "Hook accepts: { type?: 'all'|'agents'|'users', timeframe?: 'all_time'|'monthly'|'weekly' }",
      "State: entries[], loading, error, total, offset, hasMore",
      "On mount or param change: call api.getLeaderboard({ type, timeframe, limit: 50, offset })",
      "Transform API LeaderboardEntry to UI-friendly format (add profile link, format reputation)",
      "loadMore() function: increments offset, fetches next page, appends to entries[]",
      "refetch() function: resets offset to 0, clears entries, fetches from start",
      "Returns: { entries, loading, error, total, hasMore, loadMore, refetch }",
      "Create hooks/use-leaderboard.test.ts with 6 tests (TDD approach)",
      "Test: fetches from API on mount with correct params",
      "Test: transforms LeaderboardEntry data correctly (adds profileLink based on type)",
      "Test: type filter change resets to page 1 and refetches",
      "Test: timeframe filter change resets to page 1 and refetches",
      "Test: loadMore() increments offset and appends results",
      "Test: error handling displays error state",
      "Verify: all 6 tests pass"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Create /leaderboard page with tabs, filters, and ranked list",
    "steps": [
      "Create app/leaderboard/page.tsx as 'use client' component",
      "Add useState for: timeframe ('all_time'|'monthly'|'weekly'), type ('all'|'agents'|'users')",
      "Import and use useLeaderboard({ type, timeframe }) hook",
      "Page layout: Header with title 'LEADERBOARD', description, and filter controls",
      "Timeframe tabs: ALL TIME | THIS MONTH | THIS WEEK (active tab highlighted)",
      "Type filter pills: ALL | HUMANS | AGENTS (active pill highlighted)",
      "Leaderboard list: for each entry show:",
      "  - Rank badge: #1-#10 in colored badge (gold #1, silver #2, bronze #3), rest plain number",
      "  - Avatar with fallback to display_name initials",
      "  - Display name as Link to /agents/{id} or /users/{id} based on type",
      "  - Type badge: Human icon for users, Bot icon for agents",
      "  - Reputation score with '+REP' label in emerald text",
      "  - Key stats: 'X problems solved • Y answers accepted' in muted text",
      "Loading state: skeleton loaders for 10 entries",
      "Empty state: 'No entries found' with message",
      "Error state: 'Failed to load leaderboard' with retry button",
      "LOAD MORE button at bottom: visible when hasMore, calls loadMore(), shows loading spinner",
      "Add page metadata: title='Leaderboard — Solvr', description='Top contributors on Solvr'",
      "Style: consistent with /agents and /users pages (monospace fonts, border styling)",
      "Create app/leaderboard/page.test.tsx with 8 tests (TDD approach)",
      "Test: renders timeframe tabs (all time, monthly, weekly)",
      "Test: clicking timeframe tab updates active state and refetches",
      "Test: renders type filter pills (all, humans, agents)",
      "Test: clicking type pill updates filter and refetches",
      "Test: renders leaderboard entries with correct rank badges",
      "Test: rank #1-#3 have special styling (gold/silver/bronze)",
      "Test: entries link to correct profile pages based on type",
      "Test: LOAD MORE button calls loadMore() and is hidden when !hasMore",
      "Verify: all 8 tests pass"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Add LEADERBOARD navigation link to header",
    "steps": [
      "Open frontend/components/header.tsx",
      "Add LEADERBOARD link to desktop nav between AGENTS and API (line ~115)",
      "Link href: /leaderboard",
      "Style: font-mono text-xs tracking-wider text-muted-foreground hover:text-foreground transition-colors",
      "Add LEADERBOARD link to mobile menu between AGENTS and API",
      "Update frontend/components/header.test.tsx",
      "Add test: 'displays LEADERBOARD link in desktop navigation'",
      "Add test: 'displays LEADERBOARD link in mobile menu'",
      "Verify: both tests pass",
      "Verify: link appears in correct position on both desktop and mobile"
    ],
    "passes": true
  }
]
