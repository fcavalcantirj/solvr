[
  {
    "category": "backend",
    "description": "Add model field to agents table via migration",
    "steps": [
      "Create migration 000052_add_agent_model.up.sql: ALTER TABLE agents ADD COLUMN model VARCHAR(100)",
      "Create migration 000052_add_agent_model.down.sql: ALTER TABLE agents DROP COLUMN model",
      "Update Agent struct in models/agent.go: Model string json:model,omitempty",
      "Update Create() in db/agents.go to include model in INSERT",
      "Update RegisterAgent handler to accept optional model field",
      "Update agent PATCH/update to allow model changes",
      "Verify: POST /v1/agents/register with model field persists correctly"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Add karma bonus when agent model field is set",
    "steps": [
      "In RegisterAgent handler: if model is provided, add +10 karma",
      "In UpdateAgent handler: if model is being set for first time, add +10 karma",
      "Track if model was previously null to avoid duplicate bonus",
      "Verify: Agent with model on registration starts with 10 karma",
      "Verify: Agent updating model first time gets +10 karma",
      "Verify: Agent changing model does not get bonus again"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Add GET /v1/users/{id}/agents endpoint to list agents by human_id",
    "steps": [
      "Add ListByHumanID(ctx, humanID) method to AgentRepository in db/agents.go",
      "Create GetUserAgents handler in handlers/users.go",
      "Add route GET /v1/users/{id}/agents to router.go",
      "Return agent list with basic info (exclude api_key_hash)",
      "Verify: Returns correct agents for user with claimed agents",
      "Verify: Returns empty array for users with no agents"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Add GET /v1/users endpoint to list all users",
    "steps": [
      "Add List(ctx, opts) method to UserRepository in db/users.go",
      "Include agents_count via subquery: SELECT COUNT(*) FROM agents WHERE human_id = users.id",
      "Support query params: limit (default 20, max 100), offset, sort (newest/karma/agents)",
      "Create ListUsers handler in handlers/users.go",
      "Add route GET /v1/users to router.go",
      "Response includes: id, username, display_name, avatar_url, karma, agents_count, created_at",
      "Do NOT expose email or auth_provider_id",
      "Verify: Returns paginated user list with agents_count"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Verify agents cannot be re-claimed via database trigger",
    "steps": [
      "Confirm trigger_prevent_agent_reclaim exists in production database",
      "Test: UPDATE agents SET human_id = 'different_id' WHERE human_id IS NOT NULL raises error",
      "Verify: ConfirmClaim handler rejects already-claimed agents with 409 CONFLICT",
      "Document this behavior in API docs"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Wire PATCH /v1/agents/{id} route for updating agent profile",
    "steps": [
      "Open backend/internal/api/router.go",
      "UpdateAgent handler already exists in handlers/agents.go but route is NOT wired",
      "Add route: r.Patch('/agents/{id}', ...) with CombinedAuthMiddleware",
      "Handler should verify caller owns the agent (human_id matches or agent's own API key)",
      "Supports updating: display_name, bio, specialties, avatar_url, model",
      "Verify: PATCH /v1/agents/{id} with valid auth updates agent",
      "Verify: PATCH /v1/agents/{id} without auth returns 401",
      "Verify: PATCH /v1/agents/{id} by non-owner returns 403"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Add TypeScript types for claiming and user list features to lib/api-types.ts",
    "steps": [
      "Open frontend/lib/api-types.ts",
      "Add model?: string field to APIAgent interface (line ~499)",
      "Add human_id?: string field to APIAgent interface",
      "Add human_claimed_at?: string field to APIAgent interface",
      "Add APIClaimInfoResponse type: { agent?: APIAgent, token_valid: boolean, expires_at?: string, error?: string }",
      "Add APIConfirmClaimResponse type: { success: boolean, agent: APIAgent, redirect_url: string, message: string }",
      "Add APIUsersResponse type: { data: APIUserListItem[], meta: { total, page, per_page, has_more } }",
      "Add APIUserListItem type: { id, username, display_name, avatar_url, karma, agents_count, created_at }",
      "Add APIUserAgentsResponse type: { data: APIAgent[], meta: { total, page, per_page } }",
      "Verify: Types compile without errors"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Add API client methods for claiming and user features to lib/api.ts",
    "steps": [
      "Open frontend/lib/api.ts",
      "Add getClaimInfo(token): GET /v1/claim/{token} - returns APIClaimInfoResponse",
      "Add confirmClaim(token): POST /v1/claim/{token} - returns APIConfirmClaimResponse",
      "Add getUserAgents(userId): GET /v1/users/{id}/agents - returns APIUserAgentsResponse",
      "Add getUsers(params): GET /v1/users?limit&offset&sort - returns APIUsersResponse",
      "Add updateAgent(agentId, data): PATCH /v1/agents/{id} - returns { data: APIAgent }",
      "Ensure all methods handle errors and return typed responses",
      "Verify: All methods callable from frontend components"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Create /settings/agents page for agent management and claiming",
    "steps": [
      "Create frontend/app/settings/agents/page.tsx",
      "Page requires authentication - redirect to /login if not logged in",
      "Create MyAgentsList component showing user's claimed agents",
      "Fetch agents via GET /v1/users/{current_user_id}/agents",
      "Each agent card shows: display_name, bio snippet, karma, model, link to /agents/{id}",
      "Show 'No agents yet' empty state when user has no claimed agents",
      "Create ClaimAgentSection with instructions and token input",
      "Instructions text: 'To claim an agent, run solvr claim in your agent environment'",
      "Show example command: npx @solvr/cli claim OR use solvr_claim MCP tool",
      "Token input field with placeholder 'Paste claim token here'",
      "CLAIM AGENT button calls POST /v1/claim/{token}",
      "On success: show agent info, refresh my-agents list",
      "On error: show appropriate message (expired, already claimed, invalid)"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Create /claim/{token} page for direct URL claiming",
    "steps": [
      "Create frontend/app/claim/[token]/page.tsx",
      "Add getClaimInfo(token) to lib/api.ts - calls GET /v1/claim/{token}",
      "Add confirmClaim(token) to lib/api.ts - calls POST /v1/claim/{token}",
      "On page load: fetch claim info",
      "If token_valid is false: show error message from API response",
      "If user not authenticated: show agent info + 'Login to claim' button",
      "Login button redirects to /login?next=/claim/{token}",
      "If user authenticated: show agent info + 'Claim This Agent' button",
      "Display: agent display_name, bio, karma, specialties, created_at",
      "Display expires_at as countdown (e.g., 'Expires in 23 hours')",
      "On claim button click: call confirmClaim(token)",
      "On success: show celebration message + link to /agents/{id}",
      "Style consistent with /join and /login pages (monospace, minimal borders)"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Redirect /connect/agent to /settings/agents",
    "steps": [
      "Open frontend/app/connect/agent/page.tsx",
      "Replace entire 820-line file with simple redirect logic",
      "If user is authenticated: redirect to /settings/agents",
      "If user is not authenticated: redirect to /login?next=/settings/agents",
      "Verify: /connect/agent redirects appropriately based on auth state"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Add MY AGENTS item to user dropdown menu",
    "steps": [
      "Open frontend/components/ui/user-menu.tsx",
      "Import Bot icon from lucide-react",
      "Add new menu item after PROFILE: { label: 'MY AGENTS', href: '/settings/agents', icon: Bot }",
      "Open frontend/components/header.tsx",
      "Add MY AGENTS link to mobile menu in same position",
      "Verify: MY AGENTS appears in desktop dropdown and mobile menu",
      "Verify: Clicking navigates to /settings/agents"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Display Human-Backed badge on agent profile pages",
    "steps": [
      "Find agent profile header in frontend/app/agents/[id]/page.tsx or components",
      "Check if agent.has_human_backed_badge is true",
      "If true: render badge next to agent display_name",
      "Badge design: Shield icon (14px) + text 'HUMAN-BACKED'",
      "Badge style: bg-foreground text-background px-2 py-0.5 font-mono text-[10px] tracking-wider",
      "Add tooltip on hover: 'This agent is verified by a human backer'",
      "Verify: Badge appears on claimed agents",
      "Verify: Badge does not appear on unclaimed agents"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Display backed agents section on user profile pages",
    "steps": [
      "Open frontend/app/users/[id]/page.tsx",
      "Create UserAgentsSection component",
      "Fetch agents via GET /v1/users/{id}/agents",
      "Display as grid of agent cards",
      "Each card shows: display_name, bio snippet, karma, Human-Backed badge",
      "Each card links to /agents/{id}",
      "If no agents: show 'No agents backed yet' message",
      "Add section to user profile below stats section",
      "Verify: User profiles show their backed agents"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Create /users page listing all human users",
    "steps": [
      "Create frontend/app/users/page.tsx",
      "Create useUsers() hook in hooks/use-users.ts",
      "Add getUsers(params) to lib/api.ts - calls GET /v1/users",
      "Create UsersList component showing user cards in grid",
      "Each card shows: avatar, display_name, username, karma, agents_count",
      "Each card links to /users/{id}",
      "Add pagination controls",
      "Add sort dropdown: Newest, Karma, Agents",
      "Style consistent with /agents page",
      "Verify: Page loads and shows paginated user list"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Update /join page AI Agent Account button",
    "steps": [
      "Open frontend/app/join/page.tsx",
      "Find the 'AI Agent Account' button/card (currently links to /connect/agent)",
      "Update onClick handler to check authentication",
      "If logged in: navigate to /settings/agents",
      "If not logged in: navigate to /login?next=/settings/agents",
      "Update description text to: 'Claim an AI agent you operate'",
      "Verify: Button navigates correctly based on auth state"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Show model field on agent profile pages",
    "steps": [
      "Find agent profile in frontend/app/agents/[id]/page.tsx",
      "Check if agent.model is set and not empty",
      "If set: display as metadata line near specialties",
      "Format: 'MODEL: claude-opus-4' in font-mono text-xs text-muted-foreground",
      "If not set: do not render anything for model",
      "Verify: Model displays when set",
      "Verify: Nothing shows when model is null/empty"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Add edit model functionality for owned agents in settings",
    "steps": [
      "In /settings/agents page MyAgentsList component",
      "Add small 'Edit' button on each agent card",
      "Create EditAgentModal component with model input field",
      "Modal shows current model value as default",
      "On save: call PATCH /v1/agents/{id} with new model value",
      "On success: close modal, refresh agent list",
      "Verify: Human can update their agent's model from settings"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Show Human-Backed badge indicator in /agents list view",
    "steps": [
      "Open frontend/app/agents/page.tsx and find agent card component",
      "If agent.has_human_backed_badge is true: show small Shield icon (12px)",
      "Position icon next to agent name in the card",
      "Add tooltip: 'Human-backed agent'",
      "Verify: Claimed agents in /agents list show badge icon"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Add USERS link to header navigation",
    "steps": [
      "Open frontend/components/header.tsx",
      "Add USERS link to desktop nav between AGENTS and API",
      "Add USERS link to mobile nav menu",
      "Link href: /users",
      "Style: font-mono text-xs tracking-wider text-muted-foreground hover:text-foreground",
      "Verify: Link visible and navigates to /users"
    ],
    "passes": true
  },
  {
    "category": "cli",
    "description": "Add claim command to CLI for agents to generate claim tokens",
    "steps": [
      "Create cli/claim.go with ClaimCmd",
      "Command name: solvr claim",
      "Read API key from config (error if not configured)",
      "Call POST /v1/agents/me/claim with API key in Authorization header",
      "Parse response: claim_url, token, expires_at, instructions",
      "Display output in clear format:",
      "  === CLAIM YOUR AGENT ===",
      "  Claim URL: {claim_url}",
      "  Token: {token}",
      "  Expires: {human readable expiry}",
      "  Give this URL to your human to link your Solvr account.",
      "Register command in cli/main.go",
      "Verify: Command generates valid claim URL when API key is configured"
    ],
    "passes": true
  },
  {
    "category": "mcp",
    "description": "Add solvr_claim tool to MCP server",
    "steps": [
      "Create mcp-server/src/tools/claim.ts",
      "Tool name: solvr_claim",
      "Tool description: Generate a claim URL for your human to link your Solvr account",
      "Parameters: none required",
      "Implementation: call POST /v1/agents/me/claim using configured API key",
      "Return object with: claim_url, token, expires_at, instructions",
      "Handle API errors gracefully with descriptive messages",
      "Register tool in mcp-server/src/index.ts",
      "Verify: Tool appears in MCP tool list",
      "Verify: Calling tool returns valid claim URL"
    ],
    "passes": true
  },
  {
    "category": "docs",
    "description": "Document agent claiming flow in API docs page",
    "steps": [
      "Open frontend/components/api/api-endpoints.tsx",
      "Add new section: 'Agent Claiming'",
      "Document POST /v1/agents/me/claim:",
      "  - Auth: API Key (agent)",
      "  - Description: Generate claim URL for human linking",
      "  - Response: { claim_url, token, expires_at, instructions }",
      "Document GET /v1/claim/{token}:",
      "  - Auth: None",
      "  - Description: Get claim info for confirmation page",
      "  - Response: { agent, token_valid, expires_at, error }",
      "Document POST /v1/claim/{token}:",
      "  - Auth: JWT (human)",
      "  - Description: Confirm claim and link agent to human",
      "  - Response: { success, agent, redirect_url, message }",
      "Add note about +50 karma bonus and Human-Backed badge",
      "Verify: Documentation is clear and complete"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Add sort parameter to GET /v1/problems (votes, approaches, activity)",
    "steps": [
      "Add Sort field to PostListOptions in models/post.go",
      "Update PostsRepository.List() in db/posts.go to support ORDER BY based on sort param",
      "Support sort values: newest (default, created_at DESC), votes (vote_score DESC), approaches (approaches_count DESC)",
      "Parse sort query param in ProblemsHandler.List() in handlers/problems.go",
      "Write tests for each sort option in problems handler tests",
      "Verify: GET /v1/problems?sort=votes returns problems ordered by vote score",
      "Verify: GET /v1/problems?sort=approaches returns problems ordered by approach count",
      "Verify: GET /v1/problems with no sort defaults to newest"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Add GET /v1/stats/problems endpoint with problems-specific sidebar stats",
    "steps": [
      "Add GetProblemsStats() to StatsRepository in db/stats.go",
      "Query: total problems count (type='problem', deleted_at IS NULL)",
      "Query: solved problems count (type='problem', status='solved', deleted_at IS NULL)",
      "Query: active approaches count (approaches with status IN ('in_progress','exploring') and deleted_at IS NULL on problems)",
      "Query: avg solve time in days (AVG of updated_at - created_at for solved problems)",
      "Add GetProblemsStats to StatsRepositoryInterface in handlers/stats.go",
      "Create GetProblemsStats handler in handlers/stats.go",
      "Add route GET /v1/stats/problems to router.go",
      "Response shape: { data: { total_problems, solved_count, active_approaches, avg_solve_time_days } }",
      "Write tests for handler and repository",
      "Verify: Endpoint returns correct counts from production data"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Add recently-solved problems to GET /v1/stats/problems response",
    "steps": [
      "Add GetRecentlySolvedProblems(ctx, limit) to StatsRepository in db/stats.go",
      "Query: problems with status='solved', JOIN approaches to find the solver (approach author with status='succeeded' or 'verified')",
      "Include: problem id, title, solver display_name, solver type (human/agent), time_to_solve (updated_at - created_at)",
      "ORDER BY updated_at DESC, LIMIT 3",
      "Add to GetProblemsStats response: recently_solved[] array",
      "Write tests for the query",
      "Verify: Returns recently solved problems with correct solver info"
    ],
    "passes": true
  },
  {
    "category": "backend",
    "description": "Add top-solvers leaderboard to GET /v1/stats/problems response",
    "steps": [
      "Add GetTopProblemSolvers(ctx, limit) to StatsRepository in db/stats.go",
      "Query: GROUP approaches by author (author_type, author_id) WHERE approach status IN ('succeeded','verified') on non-deleted problems",
      "COUNT solved problems per author, JOIN users/agents for display_name",
      "Include: author_id, display_name, author_type (human/agent), solved_count",
      "ORDER BY solved_count DESC, LIMIT 5",
      "Add to GetProblemsStats response: top_solvers[] array",
      "Write tests for the query",
      "Verify: Returns ranked list of top problem solvers"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Add getStuckProblems() and getProblemsStats() to frontend API client",
    "steps": [
      "Open frontend/lib/api.ts",
      "Add getStuckProblems(params): GET /v1/feed/stuck?page&per_page - returns feed items",
      "Add getProblemsStats(): GET /v1/stats/problems - returns problems sidebar stats",
      "Add TypeScript types for ProblemsStatsResponse in lib/api-types.ts or inline",
      "ProblemsStatsResponse: { total_problems, solved_count, active_approaches, avg_solve_time_days, recently_solved[], top_solvers[] }",
      "Verify: Methods compile and are callable"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Create useProblems() hook for problems listing with pagination and filters",
    "steps": [
      "Create frontend/hooks/use-problems.ts",
      "Hook accepts: status, tags, sort, page, perPage as parameters",
      "Calls api.getPosts({ type: 'problem', status, tags, sort, page, per_page })",
      "Note: tags param needs adding to FetchPostsParams in api.ts if not present",
      "Returns: problems[], loading, error, total, hasMore, page, loadMore(), refetch()",
      "loadMore() increments page and appends results",
      "Refetches when filter params change (reset to page 1)",
      "Write Vitest tests using vi.mock for the hook",
      "Verify: Hook fetches and returns real problems data"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Replace hardcoded problems list with real API data in problems-list.tsx",
    "steps": [
      "Open frontend/components/problems/problems-list.tsx",
      "Remove the entire hardcoded problems[] array (lines 25-140)",
      "Remove the local Problem interface (lines 6-23)",
      "Import and use useProblems() hook from hooks/use-problems.ts",
      "Accept filter props from parent: status, tags, sort, searchQuery",
      "Map API PostWithAuthor data to existing card UI (preserve exact look&feel)",
      "Map fields: title, description, tags, vote_score→votes, approaches_count, author info, created_at→relative time",
      "Map weight from API (1-5 int) to display labels (critical/high/medium/low)",
      "Map status from API to existing statusConfig display",
      "Add loading skeleton state (Loader2 spinner)",
      "Add empty state when no problems returned",
      "Add error state",
      "Verify: Real problems from API display with identical look&feel to current mock"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Wire problems-filters.tsx to trigger real API calls",
    "steps": [
      "Lift filter state from problems-filters.tsx to parent problems/page.tsx",
      "Pass filter state down to both ProblemsFilters and ProblemsList as props",
      "ProblemsFilters calls onFilterChange callbacks that update parent state",
      "ProblemsList receives filter state and passes to useProblems() hook",
      "Search input: debounce 300ms, then call api.search({ q, type: 'problem' }) or pass to getPosts",
      "Status filter: maps to API status param",
      "Sort filter: maps to API sort param (newest, votes, approaches)",
      "Tags filter: maps to API tags param (comma-separated)",
      "Weight filter: needs backend support (task 23 sort covers this) or client-side filter",
      "When filters change, reset to page 1 and refetch",
      "Popular tags in filter panel: fetch from useTrending() instead of hardcoded list",
      "Verify: Changing any filter updates the problems list with matching results"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Wire problems sidebar stats to useStats() hook (replace hardcoded numbers)",
    "steps": [
      "Open frontend/components/problems/problems-sidebar.tsx",
      "Import useProblemsStats hook (or create inline fetch for /v1/stats/problems)",
      "Remove hardcoded stats array (lines 5-10)",
      "Map API response to sidebar: total_problems→TOTAL PROBLEMS, solved_count→SOLVED, active_approaches→ACTIVE APPROACHES, avg_solve_time_days→AVG. SOLVE TIME",
      "Format avg_solve_time_days as '4.2d' style",
      "Add loading state (show '—' while loading, like homepage)",
      "Verify: Sidebar shows real stats from API"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Wire sidebar NEEDS FRESH EYES section to /v1/feed/stuck endpoint",
    "steps": [
      "In problems-sidebar.tsx, remove hardcoded stuckProblems array (lines 12-31)",
      "Call api.getStuckProblems({ page: 1, per_page: 3 }) on mount",
      "Map response to existing UI: title, approaches count, days since last update",
      "Calculate daysSinceUpdate from item.created_at or updated_at",
      "Make items clickable: Link to /problems/{id}",
      "Make VIEW ALL STUCK PROBLEMS button navigate to /problems?status=stuck or apply filter",
      "Add loading and empty states",
      "Verify: Shows real stuck problems from API"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Wire sidebar RECENTLY SOLVED and TOP SOLVERS to /v1/stats/problems",
    "steps": [
      "In problems-sidebar.tsx, remove hardcoded recentlySolved array (lines 33-52)",
      "Remove hardcoded topSolvers array (lines 54-60)",
      "Fetch from api.getProblemsStats() which returns recently_solved[] and top_solvers[]",
      "RECENTLY SOLVED: map solver.name, solver.type (human/ai icon), time_to_solve",
      "Make items clickable: Link to /problems/{id}",
      "TOP SOLVERS: map name, type (human/ai icon), solved_count, optionally streak if API provides",
      "Make solver names link to /users/{id} or /agents/{id} based on type",
      "Add loading and empty states for both sections",
      "Verify: Shows real recently solved and top solver data"
    ],
    "passes": true
  },
  {
    "category": "frontend",
    "description": "Wire sidebar TRENDING TAGS to useTrending() hook",
    "steps": [
      "In problems-sidebar.tsx, remove hardcoded hotTags array (lines 62-69)",
      "Import useTrending from hooks/use-stats",
      "Map trending.tags to existing tag buttons: name→tag text, count→count display",
      "Make tag buttons clickable: clicking a tag applies it as a filter (pass callback to parent)",
      "Add loading state",
      "Verify: Shows real trending tags with counts from API"
    ],
    "passes": false
  },
  {
    "category": "frontend",
    "description": "Make all /problems page buttons functional (POST A PROBLEM, LOAD MORE, CTAs)",
    "steps": [
      "POST A PROBLEM button (desktop header + mobile fixed): navigate to /problems/new if authenticated, /login?next=/problems/new if not",
      "Create frontend/app/problems/new/page.tsx with problem creation form",
      "Form fields: title, description, tags (multi-select), success_criteria (list input), weight (1-5 select)",
      "On submit: call api.createPost({ type: 'problem', ...fields })",
      "On success: redirect to /problems/{new_id}",
      "LOAD MORE button in problems-list.tsx: call loadMore() from useProblems hook, show loading spinner, hide when !hasMore",
      "BROWSE OPEN PROBLEMS sidebar CTA: apply status=open filter or navigate to /problems?status=open",
      "Verify: All buttons trigger correct actions"
    ],
    "passes": false
  },
  {
    "category": "SEO-URGENT",
    "description": "Create GET /v1/sitemap/urls endpoint returning all indexable content for sitemap generation",
    "steps": [
      "Create backend/internal/db/sitemap.go with GetSitemapURLs(ctx) method",
      "Query posts: SELECT id, type, updated_at FROM posts WHERE deleted_at IS NULL AND status NOT IN ('draft') ORDER BY updated_at DESC",
      "Query agents: SELECT id, updated_at FROM agents WHERE status = 'active' ORDER BY updated_at DESC",
      "Query users: SELECT id, updated_at FROM users ORDER BY updated_at DESC",
      "Return combined struct: { posts: [{id, type, updated_at}], agents: [{id, updated_at}], users: [{id, updated_at}] }",
      "Create backend/internal/api/handlers/sitemap.go with GetSitemapURLs handler",
      "No auth required — this is public data",
      "Add route GET /v1/sitemap/urls to router.go (public group)",
      "Write tests: returns all non-draft non-deleted posts, excludes drafts, excludes deleted, includes active agents, includes users",
      "Verify: curl /v1/sitemap/urls returns JSON with all 3 arrays populated"
    ],
    "passes": true
  },
  {
    "category": "SEO-URGENT",
    "description": "Create robots.ts with crawl rules and sitemap reference",
    "steps": [
      "Create frontend/app/robots.ts exporting MetadataRoute.Robots",
      "Rules: Allow / for all user-agents",
      "Disallow: /settings/, /auth/, /login, /join, /new, /admin/",
      "Sitemap: https://solvr.dev/sitemap.xml",
      "Host: https://solvr.dev",
      "Write Vitest test: verify robots() returns correct rules, sitemap URL, and disallow paths",
      "Verify: curl https://solvr.dev/robots.txt shows correct output"
    ],
    "passes": true
  },
  {
    "category": "SEO-URGENT",
    "description": "Create sitemap.ts that feeds Google every post, agent, and user URL with lastmod",
    "steps": [
      "Add getSitemapUrls() to frontend/lib/api.ts — GET /v1/sitemap/urls, no auth",
      "Create frontend/app/sitemap.ts exporting default async function returning MetadataRoute.Sitemap",
      "Fetch all URLs from api.getSitemapUrls()",
      "Static pages: / (priority 1.0, daily), /feed (0.9, hourly), /problems (0.9, hourly), /questions (0.9, hourly), /ideas (0.9, hourly), /agents (0.8, daily), /about (0.3, monthly), /how-it-works (0.3, monthly), /api-docs (0.5, weekly), /mcp (0.5, weekly)",
      "Dynamic posts: map each post to /{type}s/{id} (e.g., /problems/{id}), priority 0.7, lastModified from updated_at, changeFrequency weekly",
      "Dynamic agents: /agents/{id}, priority 0.6, lastModified from updated_at, changeFrequency weekly",
      "Dynamic users: /users/{id}, priority 0.5, lastModified from updated_at, changeFrequency monthly",
      "Graceful fallback: if API unavailable, return static pages only",
      "Write Vitest tests: mock API response, verify all URL patterns generated, verify priorities, verify lastModified dates, verify fallback on API error",
      "Verify: curl https://solvr.dev/sitemap.xml returns valid XML with all content URLs"
    ],
    "passes": true
  },
  {
    "category": "SEO-URGENT",
    "description": "Add metadataBase, OpenGraph defaults, and Twitter card config to root layout.tsx",
    "steps": [
      "Add metadataBase: new URL('https://solvr.dev') to metadata export in frontend/app/layout.tsx",
      "Add openGraph defaults: { type: 'website', siteName: 'Solvr', locale: 'en_US' }",
      "Add twitter defaults: { card: 'summary_large_image', site: '@solvrdev' }",
      "Add keywords: 'developer knowledge base, AI agents, coding help, programming Q&A, collective intelligence'",
      "Update title to use template: { default: 'Solvr — Collective Intelligence for Humans & AI', template: '%s | Solvr' }",
      "Verify: view-source on homepage shows OG and Twitter meta tags"
    ],
    "passes": true
  },
  {
    "category": "SEO-URGENT",
    "description": "Add generateMetadata to /problems/[id], /questions/[id], /ideas/[id] for dynamic SEO",
    "steps": [
      "In frontend/app/problems/[id]/page.tsx: export async function generateMetadata({ params })",
      "Fetch problem from API: api.getPost(id)",
      "Return: title (post.title), description (post.description truncated to 160 chars), openGraph (title, description, type: 'article', url), twitter (title, description)",
      "Handle not-found: return default metadata if API returns 404",
      "Repeat for frontend/app/questions/[id]/page.tsx with same pattern",
      "Repeat for frontend/app/ideas/[id]/page.tsx with same pattern",
      "Write Vitest tests for each: mock API, verify title/description/OG returned",
      "Verify: view-source on any post page shows correct title and meta description from actual content"
    ],
    "passes": true
  },
  {
    "category": "SEO-URGENT",
    "description": "Add generateMetadata to /agents/[id] and /users/[id] for profile SEO",
    "steps": [
      "In frontend/app/agents/[id]/page.tsx: export async function generateMetadata({ params })",
      "Fetch agent from API: api.getAgent(id)",
      "Return: title (agent.display_name), description (agent.bio truncated to 160 chars, or 'AI agent on Solvr'), openGraph, twitter",
      "In frontend/app/users/[id]/page.tsx: export async function generateMetadata({ params })",
      "Fetch user from API: api.getUser(id)",
      "Return: title (user.display_name), description (user.bio truncated to 160 chars, or 'Developer on Solvr'), openGraph, twitter",
      "Handle not-found: return default metadata if API returns 404",
      "Write Vitest tests for both: mock API, verify metadata returned",
      "Verify: view-source on agent/user profile shows correct title and description"
    ],
    "passes": true
  },
  {
    "category": "SEO-URGENT",
    "description": "Add Google Search Console verification and submit sitemap",
    "steps": [
      "Add Google Search Console verification meta tag to frontend/app/layout.tsx metadata.verification",
      "Deploy frontend with sitemap.ts and robots.ts",
      "Submit https://solvr.dev/sitemap.xml in Google Search Console",
      "Request indexing for homepage and top content pages",
      "Verify: Search Console shows sitemap as submitted with URL count matching database"
    ],
    "passes": false
  }
]
