2026-02-07: Add model field to agents table
- Created migration 000025_add_agent_model.up.sql and down.sql
- Added Model field to Agent struct in models/agent.go
- Updated db/agents.go: agentColumns, Create(), Update(), scanAgent(), scanAgentRows()
- Updated RegisterAgentRequest to include optional model field
- Updated UpdateAgentRequest to include optional model field
- Updated RegisterAgent handler to validate and persist model
- Updated UpdateAgent handler to allow model changes
- Added tests: TestAgentRepository_Create_WithModel, TestAgentRepository_Create_WithoutModel, TestAgentRepository_Update_WithModel
- All tests pass, build successful

2026-02-07: Add karma bonus when agent model field is set
- Updated RegisterAgent handler: +10 karma when model is provided on registration
- Updated UpdateAgent handler: +10 karma when model is set for first time (was empty)
- Tracks previous model state to avoid duplicate bonus when changing models
- Added tests: TestRegisterAgent_ModelKarmaBonus, TestRegisterAgent_NoModelNoKarmaBonus
- Added tests: TestUpdateAgent_ModelKarmaBonus_FirstTime, TestUpdateAgent_ModelKarmaBonus_NoBonus
- All agent tests pass

2026-02-07: Add GET /v1/users/{id}/agents endpoint
- FindByHumanID method already existed in db/agents.go
- Added FindByHumanID to AgentRepositoryInterface in handlers/agents.go
- Added UsersAgentRepositoryInterface to handlers/users.go
- Added SetAgentRepository method and agentRepo field to UsersHandler
- Created GetUserAgents handler to list agents by human_id
- Added route GET /v1/users/{id}/agents to router.go
- Updated InMemoryAgentRepository and all mock repositories with FindByHumanID
- Added tests: TestGetUserAgents_Success, TestGetUserAgents_Empty, TestGetUserAgents_MissingUserID
- Returns agent list with basic info (api_key_hash excluded)
- Returns empty array for users with no agents
- All agent and user tests pass

2026-02-07: Add GET /v1/users endpoint to list all users
- Added UserListItem and PublicUserListOptions models to models/user.go
- Added List method to UserRepository in db/users.go with agents_count subquery
- Added UsersUserListRepositoryInterface to handlers/users.go
- Added SetUserListRepository method and userListRepo field to UsersHandler
- Created ListUsers handler with limit/offset/sort query params
- Limit defaults to 20, max 100; sort: newest (default), karma, agents
- Added route GET /v1/users to router.go
- Added tests: TestListUsers_Success, TestListUsers_WithPagination, TestListUsers_LimitMax100, TestListUsers_DefaultLimit20, TestListUsers_Empty
- Response includes: id, username, display_name, avatar_url, karma, agents_count, created_at
- Does NOT expose email or auth_provider_id
- All user tests pass

2026-02-07: Wire PATCH /v1/agents/{id} route for updating agent profile
- Updated UpdateAgent handler to support both JWT and API key auth
- Human owner can update via JWT (human_id must match)
- Agent can update itself via API key (agentID must match)
- Added route PATCH /v1/agents/{id} to router.go with CombinedAuthMiddleware
- Added tests: TestUpdateAgent_WithAPIKey, TestUpdateAgent_APIKey_WrongAgent
- All agent tests pass

2026-02-07: Verify agents cannot be re-claimed via database trigger
- Confirmed trigger_prevent_agent_reclaim exists in migration 000018_add_agent_claim_fields.up.sql
- Trigger prevents UPDATE of human_id when already set (raises error with ERRCODE P0001)
- ConfirmClaim handler checks agent.HumanID != nil and returns 409 CONFLICT with "AGENT_ALREADY_CLAIMED"
- Test TestConfirmClaim_AgentAlreadyClaimed_Returns409 verifies this behavior
- All claim tests pass

2026-02-07: Add TypeScript types for claiming and user list features
- Added model?, human_id?, human_claimed_at? fields to APIAgent interface
- Added APIClaimInfoResponse type: { agent?, token_valid, expires_at?, error? }
- Added APIConfirmClaimResponse type: { success, agent, redirect_url, message }
- Added APIUserListItem type: { id, username, display_name, avatar_url?, karma, agents_count, created_at }
- Added APIUsersResponse type with data and meta pagination
- Added APIUserAgentsResponse type with data and meta
- Types compile without errors

2026-02-07: Add API client methods for claiming and user features
- Added getClaimInfo(token): GET /v1/claim/{token}
- Added confirmClaim(token): POST /v1/claim/{token}
- Added getUserAgents(userId, params?): GET /v1/users/{id}/agents
- Added getUsers(params?): GET /v1/users?limit&offset&sort
- Added updateAgent(agentId, data): PATCH /v1/agents/{id}
- All methods use typed responses and handle errors via fetch wrapper
- Types compile without errors

2026-02-07: Create /settings/agents page for agent management and claiming
- Created frontend/app/settings/agents/page.tsx
- Added MY AGENTS nav item to settings-layout.tsx with Bot icon
- MyAgentsList shows user's claimed agents with display_name, bio, karma, model
- Agent cards link to /agents/{id} and show HUMAN-BACKED badge if applicable
- Empty state shows "No agents yet" message
- ClaimAgentSection with instructions for CLI and MCP tool
- Token input with CLAIM AGENT button calls POST /v1/claim/{token}
- Success shows agent info with link, error shows appropriate messages
- Uses SettingsLayout which handles auth redirect

2026-02-07: Create /claim/[token] page for direct URL claiming
- Created frontend/app/claim/[token]/page.tsx
- Fetches claim info via GET /v1/claim/{token} on page load
- Shows error state for invalid/expired tokens
- Unauthenticated: shows agent info + "Login to claim" button (redirects to /login?next=/claim/{token})
- Authenticated: shows agent info + "Claim This Agent" button
- Displays: display_name, bio, karma, post_count, created_at
- Shows expires_at countdown (e.g., "Expires in 23h 45m")
- Success state: shows celebration with HUMAN-BACKED badge earned + link to /agents/{id}
- Error handling for expired, already_claimed, invalid tokens
